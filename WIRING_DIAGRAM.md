# Схема подключения iPhone Power Monitor

## Компоненты:
- Wemos D1 Mini (ESP8266)
- OLED дисплей 0.96" I2C (SSD1306)
- Транзистор MOSFET IRFZ44N
- Шунт 0.1 Ом (или резистор 0.1 Ом, 5Вт)
- Резисторы: 10кОм, 51кОм, 330Ом, 10кОм (подтяжка)
- Потенциометр 10кОм (опционально)
- Блок питания 5В 2А

## Схема подключения:

### OLED дисплей (I2C):
```
OLED Display    ->  Wemos D1 Mini
VCC             ->  3.3V
GND             ->  GND
SDA             ->  D2 (GPIO4)
SCL             ->  D1 (GPIO5)
```

### Силовая часть:
```
Блок питания 5В -> Шунт 0.1Ом -> Drain IRFZ44N -> iPhone/нагрузка
                                      |
                                   Source -> GND

Gate IRFZ44N <- Резистор 330Ом <- D5 (GPIO14) Wemos
Gate IRFZ44N <- Резистор 10кОм (подтяжка к GND)
```

### Измерение тока (через шунт):
```
Шунт 0.1Ом:
Вход (+) -> Делитель напряжения -> A0 Wemos
Выход (-) -> GND

Делитель напряжения:
Вход шунта -> Резистор 51кОм -> A0 -> Резистор 10кОм -> GND
```

### Потенциометр управления (опционально):
```
Потенциометр 10кОм:
Один конец -> 3.3V
Средний вывод -> A0 (через мультиплексор или отдельный АЦП)
Другой конец -> GND
```

## Принцип работы:

1. **Измерение тока**: Ток проходит через шунт 0.1Ом, создавая падение напряжения U = I × R
2. **Делитель напряжения**: Снижает напряжение до безопасного уровня для АЦП (0-3.3В)
3. **Защита от КЗ**: При превышении 1А транзистор отключается
4. **Управление**: MOSFET IRFZ44N управляется сигналом с D5
5. **Индикация**: OLED показывает ток, напряжение, мощность и график

## Расчеты:

### Делитель напряжения:
- Коэффициент деления: 10кОм / (10кОм + 51кОм) = 0.164
- При токе 1А: напряжение на шунте = 0.1В
- Напряжение на АЦП: 0.1В × 0.164 = 0.0164В

### Максимальный измеряемый ток:
- Максимальное напряжение АЦП: 3.3В
- Максимальное напряжение на шунте: 3.3В / 0.164 = 20.1В
- Максимальный ток: 20.1В / 0.1Ом = 201А (теоретически)

## Безопасность:
- Резистор 330Ом ограничивает ток затвора MOSFET
- Подтяжка 10кОм обеспечивает надежное выключение
- Программная защита отключает питание при превышении 1А
- Шунт должен выдерживать мощность: P = I²R = 1² × 0.1 = 0.1Вт (минимум)

## Примечания:
- Используйте шунт на 5Вт для надежности
- IRFZ44N может коммутировать до 49А при правильном охлаждении
- Добавьте радиатор на MOSFET при больших токах
- Калибровка может потребоваться для точных измерений